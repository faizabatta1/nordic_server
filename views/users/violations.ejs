<!DOCTYPE html>
<html>
<head>
    <title>K.S (Kjøring Skade) History</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>

   

        .violation-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            background-color: #f5f5f5;
        }

        .violation-date {
            font-weight: bold;
            color: #007bff;
        }

        .violation-description {
            margin-top: 10px;
        }

        #violationsFilter {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 12px;
        }
    </style>
</head>
<body>
<%- include('../components/navbar') %>
<div class="mt-4"></div>
<div class="container">
    <div class="d-flex justify-content-between align-items-center">
      <select name="violationsFilter" id="violationsFilter" class="mr-3">
        <option value="0">Hele tiden</option>
        <option value="6">I går</option>
        <option value="1">I dag</option>
        <option value="2">3 dager siden</option>
        <option value="3">en uke siden</option>
        <option value="4">en måned siden</option>
        <option value="5">ett år siden</option>
      </select>

      <div id="vio-num"></div>
    </div>

    <div id="violations">
        <!-- Violation cards will be dynamically added here using JavaScript -->
    </div>
</div>

<script>
    // Sample data for violations (replace with actual data)
    const violationsData = [
        {
            date: "2023-08-15",
            description: "Speeding in a residential area."
        },
        {
            date: "2023-09-05",
            description: "Running a red light."
        },
        {
            date: "2023-09-20",
            description: "Illegal parking."
        }
        // Add more violation entries as needed
    ];

    // Function to display violations
    function displayViolations() {
        const violationsContainer = document.getElementById('violations');

        violationsData.forEach(violation => {
            const violationCard = document.createElement('div');
            violationCard.classList.add('violation-card');

            const violationDate = document.createElement('p');
            violationDate.classList.add('violation-date');
            violationDate.textContent = `Date: ${violation.date}`;

            const violationDescription = document.createElement('p');
            violationDescription.classList.add('violation-description');
            violationDescription.textContent = `Description: ${violation.description}`;

            violationCard.appendChild(violationDate);
            violationCard.appendChild(violationDescription);

            violationsContainer.appendChild(violationCard);
        });
    }

    // Call the function to display violations when the page loads
    window.addEventListener('DOMContentLoaded', () => {
        displayViolations();
    });
</script>

<script>
  async function fetchData(url) {
      const response = await fetch(url);
      if (response.status === 200) {
          return await response.json();
      } else {
          throw new Error('Failed to fetch data');
      }
  }

  async function updateCount() {
      const vioHolder = document.getElementById('vio-num');
      const selectVio = document.getElementById('violationsFilter');
      const value = selectVio.value;

      try {
          let responseData = await fetchData(`/api/violations/${value}`);
          vioHolder.textContent = responseData;
      } catch (error) {
          console.error(error);
      }
  }

  document.addEventListener('DOMContentLoaded', () => {
      updateCount();

      const selectVio = document.getElementById('violationsFilter');
      selectVio.addEventListener('change', updateCount);
  });
</script>
</body>
</html>
